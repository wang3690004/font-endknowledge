###http缓存

####前言 
对于一个网络请求来说可以分为:发起网络请求、后端处理、浏览器响应三个步骤。浏览器缓存可以帮助我们在第一和第三步骤优化性能，比如使用强缓存，直接可以不发起请求，或者协商缓存，发起了请求和服务器数据进行比对，通过判断来确定是否进行缓存或者获取数据
![浏览器缓存](../src/imgs/浏览器缓存机制脑图.png)

####缓存位置
1. service worker， 运行在浏览器背后的独立线程，一般可以用来实现缓存功能，使用service worker的话，传输协议必须是https， 因为service worker涉及到请求拦截。 service worker 的缓存与浏览器其他内建缓存机制不同，他可以让我们自由控制缓存哪些文件 如何匹配 读取。
 service worker 实现缓存的功能一般分为三个步骤：首先注册service worker，然后监听到install事件以后就可以缓存需要的文件，那么下次用户访问的时候就可以拦截请求的方式查询是否存在缓存。如果有就用 没有就请求数据

2. memory cache 主要包含的是当前页面中已经抓取到的资源，例如页面上已经下载的样式 图片脚本等。读取内存速度自然是快的，可是缓存的持续性会很短，会随着进程释放而释放，**一旦关闭tab 页面或者浏览器 也就释放掉了**
内存中有一块重要的缓存资源是preloader 相关指令（<link rel='prefetch'）下载的资源。需要注意的是**内存缓存在缓存资源时不关心返回资源的http缓存头cache-control是什么值，同时资源的匹配也并非仅仅针对url做匹配，也可能对content-type cors等其他特征做校验**
  
3.disk cache 速度相较于memeory 慢 但是胜在容量和实效性更好.在所有的浏览器缓存中，disk cache覆盖面是最大的，他会根据http header中的字段判断哪些资源需要缓存，哪些资源可以不请求直接使用，哪些资源已经过期需要重新请求，并且即使在跨站点的情况下，相同地址的资源一旦被硬盘缓存下来，就不会在区请求数据，
 
####缓存过程分析
浏览器与服务器通信的方式为应答模式： 浏览器发起http请求-服务器响应该请求，那么浏览器如何确定一个资源该不该缓存，若何去缓存呢，浏览器第一次向服务器发起请求后拿到请求结果后，将**请求结果和缓存标识**存入浏览器缓存，浏览器对于缓存的处理是根据第一次请求资源返回的响应头来确定的 

1.发起http请求之前需要判断 浏览器对应的资源是否有缓存，如果没有缓存（缓存数据和缓存标识）的话那么直接发起正常发送http请求， 服务器会将请求的结果和缓存规则一同发送给浏览器中，这个时候浏览器会将结果和标识 放入浏览器缓存中

**浏览器每次发起请求，都会现在浏览器缓存中查找该请求的结果以及缓存标识**
**浏览器每次拿到返回的结果都会将结果和缓存标识放入浏览器缓存中**

####强缓存




感谢一下博客的内容分享： 
https://www.jianshu.com/p/54cc04190252
https://www.cnblogs.com/ranyonsue/p/8918908.html 
